http {
   # Создаем shared memory zone для rate limiting:
   # $binary_remote_addr - ключ для определения клиента
   # zone=one:10m - название зоны и размер в памяти (10 мегабайт)
   # rate=10r/m - ограничение 10 запросов в минуту (ага, именно минут)
   limit_req_zone $binary_remote_addr zone=one:10m rate=10r/m;

   # Настройка upstream для балансировки нагрузки
   upstream backend_servers {
       server backend1.example.com;
       server backend2.example.com;
       server backend3.example.com;
   }

   server {
       listen 80;

       location / {
           # Применяем rate limiting:
           # burst=5 - разрешаем обработку 5 дополнительных запросов в очереди
           # nodelay - запросы сверх rate обрабатываются немедленно пока есть burst
           limit_req zone=one burst=5 nodelay;

           # Код ответа 429 при достижении лимита
           limit_req_status 429;

           proxy_pass http://backend_servers;
       }
   }
}